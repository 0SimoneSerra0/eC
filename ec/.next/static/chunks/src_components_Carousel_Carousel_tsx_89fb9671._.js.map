{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/s/Documents/Programmazione/GitHub/MyRepositories/eC/ec/src/components/Carousel/Carousel.tsx"],"sourcesContent":["\"use client\";\nimport { useQuery } from \"@tanstack/react-query\"\nimport { getProducts } from \"@/lib/graphql/graphql\";\nimport { ReactElement, useEffect, useRef, useState } from \"react\";\nimport gsap from \"gsap\";\nimport \"./Carousel.css\"\n\n\n\nconst carouselTransition = 0.4; // in seconds\nconst scrollInterval = 5; // in seconds\n\n\nfunction renderImgs(imgsInfo: [string, string][]): ReactElement[] {\n    return imgsInfo.map<ReactElement>((imgInfo, i) => <img key={i} src={String(imgInfo[0])} alt={imgInfo[1]} className=\"cursor-pointer\" />);\n}\n\n\nexport type CarouselElement = {\n    img: string,\n    imgAlt: string,\n    link: string\n}\n\nexport function Carousel(props: { elements: CarouselElement[] }) {\n    const [imgs, setImgs] = useState<ReactElement[]>([]);\n    const [index, setIndex] = useState(0);\n    const [autoScroll, setAutoScroll] = useState(true);\n    const autoScrollInterval = useRef<NodeJS.Timeout>(null);\n    const currentTween = useRef<gsap.core.Tween>(null);\n\n\n    useEffect(() => {\n        const imgsInfo: [string, string][] = [];\n        props.elements.forEach(el => imgsInfo.push([el.img, el.imgAlt]));\n\n        if (imgs.length === 0 && props.elements.length !== 0 && autoScroll) {\n            activeAutoScroll();\n        }\n\n        setImgs(renderImgs(imgsInfo));\n    }, [props.elements]);\n\n\n    function activeAutoScroll() {\n\n        if (!autoScrollInterval.current?.hasRef())\n            console.log(\"ciao\");\n            autoScrollInterval.current = setInterval(() => {\n                if (index >= imgs.length - 1)\n                    setIndex(0);\n                else\n                    setIndex(prevIndex => prevIndex++);\n            }, scrollInterval * 1000)\n\n    }\n\n    useEffect(() => {\n\n        if (imgs.length == 0) {\n            return;\n        }\n\n        if (autoScroll) {\n            activeAutoScroll();\n        } else {\n            if(autoScrollInterval.current?.hasRef()){\n                autoScrollInterval.current.close();\n                autoScrollInterval.current = null;\n            }\n        }\n    }, [autoScroll])\n\n\n    useEffect(() => {\n        const dotsDiv = document.querySelector<HTMLDivElement>(\".carousel-dots-container\");\n        if (dotsDiv) {\n\n            const dots = [...dotsDiv.children];\n            dots.forEach(dot => {\n                dotsDiv.removeChild(dot);\n            });\n\n            for (let i = 0; i < imgs.length; i++) {\n                const newDot = document.createElement(\"div\");\n                newDot.classList.add(\"carousel-dot\");\n                dotsDiv.appendChild(newDot);\n            }\n        }\n\n\n    }, [imgs]);\n\n\n    // This function Shows the image with the index equal to the state variable\n    function selectActiveImage() {\n\n        const images = document.querySelectorAll<HTMLImageElement>(\".carousel img\");\n\n        if (images && images.length > 0) {\n            const img = images[index] as HTMLImageElement;\n            img.classList.add(\"active\");\n\n            gsap.to(img, {\n                opacity: 1,\n                duration: carouselTransition,\n            });\n        }\n    }\n\n    // This functon hide the previously active image and call 'selectActiveImage' right after. Also changes the selected dot at the bottom of the carousel\n    useEffect(() => {\n\n        // Image selection\n        const activeImg = document.querySelector<HTMLImageElement>(\".carousel img.active\");\n        if (activeImg) {\n\n            if (currentTween.current && currentTween.current.isActive()) {\n                currentTween.current.kill();\n                currentTween.current = null;\n            }\n\n            currentTween.current = gsap.to(activeImg, {\n                opacity: 0,\n                duration: carouselTransition,\n            });\n\n            currentTween.current.then(() => {\n                activeImg.classList.toggle(\"active\");\n                selectActiveImage();\n            });\n\n        } else {\n            selectActiveImage();\n        }\n\n        // Dot selection\n        const currentDot = document.querySelector(\".selected-carousel-dot\");\n        currentDot?.classList.remove(\"selected-carousel-dot\");\n        const dots = document.querySelectorAll(\".carousel-dot\");\n        if (dots) {\n            if (index < dots.length)\n                dots[index].classList.add(\"selected-carousel-dot\")\n        }\n    }, [index, imgs]);\n\n\n\n    function increaseIndex() {\n        if (imgs.length == 0)\n            return;\n\n        setIndex(prevIndex => prevIndex >= imgs.length - 1 ? 0 : prevIndex + 1);\n    }\n    function decreaseIndex() {\n        if (imgs.length <= 0)\n            return;\n\n        setIndex(prevIndex => prevIndex <= 0 ? imgs.length - 1 : prevIndex - 1);\n    }\n\n    // const { data, error } = useQuery({\n    //     queryKey: [\"products\"],\n    //     queryFn: () => getProducts(),\n    // });\n\n    return (\n        <div className=\"carousel\">\n            <button className=\"carousel-arrow left\" onClick={decreaseIndex}>❮</button>\n            {imgs}\n            <button className=\"carousel-arrow right\" onClick={increaseIndex}>❯</button>\n            <div className=\"carousel-dots-container\">\n\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":";;;;AAGA;AACA;;;AAJA;;;;AASA,MAAM,qBAAqB,KAAK,aAAa;AAC7C,MAAM,iBAAiB,GAAG,aAAa;AAGvC,SAAS,WAAW,QAA4B;IAC5C,OAAO,SAAS,GAAG,CAAe,CAAC,SAAS,kBAAM,6LAAC;YAAY,KAAK,OAAO,OAAO,CAAC,EAAE;YAAG,KAAK,OAAO,CAAC,EAAE;YAAE,WAAU;WAAvD;;;;;AAChE;AASO,SAAS,SAAS,KAAsC;;IAC3D,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB,EAAE;IACnD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,qBAAqB,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAClD,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAmB;IAG7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACN,MAAM,WAA+B,EAAE;YACvC,MAAM,QAAQ,CAAC,OAAO;sCAAC,CAAA,KAAM,SAAS,IAAI,CAAC;wBAAC,GAAG,GAAG;wBAAE,GAAG,MAAM;qBAAC;;YAE9D,IAAI,KAAK,MAAM,KAAK,KAAK,MAAM,QAAQ,CAAC,MAAM,KAAK,KAAK,YAAY;gBAChE;YACJ;YAEA,QAAQ,WAAW;QACvB;6BAAG;QAAC,MAAM,QAAQ;KAAC;IAGnB,SAAS;YAEA;QAAL,IAAI,GAAC,8BAAA,mBAAmB,OAAO,cAA1B,kDAAA,4BAA4B,MAAM,KACnC,QAAQ,GAAG,CAAC;QACZ,mBAAmB,OAAO,GAAG,YAAY;YACrC,IAAI,SAAS,KAAK,MAAM,GAAG,GACvB,SAAS;iBAET,SAAS,CAAA,YAAa;QAC9B,GAAG,iBAAiB;IAE5B;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YAEN,IAAI,KAAK,MAAM,IAAI,GAAG;gBAClB;YACJ;YAEA,IAAI,YAAY;gBACZ;YACJ,OAAO;oBACA;gBAAH,KAAG,8BAAA,mBAAmB,OAAO,cAA1B,kDAAA,4BAA4B,MAAM,IAAG;oBACpC,mBAAmB,OAAO,CAAC,KAAK;oBAChC,mBAAmB,OAAO,GAAG;gBACjC;YACJ;QACJ;6BAAG;QAAC;KAAW;IAGf,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACN,MAAM,UAAU,SAAS,aAAa,CAAiB;YACvD,IAAI,SAAS;gBAET,MAAM,OAAO;uBAAI,QAAQ,QAAQ;iBAAC;gBAClC,KAAK,OAAO;0CAAC,CAAA;wBACT,QAAQ,WAAW,CAAC;oBACxB;;gBAEA,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,EAAE,IAAK;oBAClC,MAAM,SAAS,SAAS,aAAa,CAAC;oBACtC,OAAO,SAAS,CAAC,GAAG,CAAC;oBACrB,QAAQ,WAAW,CAAC;gBACxB;YACJ;QAGJ;6BAAG;QAAC;KAAK;IAGT,2EAA2E;IAC3E,SAAS;QAEL,MAAM,SAAS,SAAS,gBAAgB,CAAmB;QAE3D,IAAI,UAAU,OAAO,MAAM,GAAG,GAAG;YAC7B,MAAM,MAAM,MAAM,CAAC,MAAM;YACzB,IAAI,SAAS,CAAC,GAAG,CAAC;YAElB,gJAAA,CAAA,UAAI,CAAC,EAAE,CAAC,KAAK;gBACT,SAAS;gBACT,UAAU;YACd;QACJ;IACJ;IAEA,sJAAsJ;IACtJ,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YAEN,kBAAkB;YAClB,MAAM,YAAY,SAAS,aAAa,CAAmB;YAC3D,IAAI,WAAW;gBAEX,IAAI,aAAa,OAAO,IAAI,aAAa,OAAO,CAAC,QAAQ,IAAI;oBACzD,aAAa,OAAO,CAAC,IAAI;oBACzB,aAAa,OAAO,GAAG;gBAC3B;gBAEA,aAAa,OAAO,GAAG,gJAAA,CAAA,UAAI,CAAC,EAAE,CAAC,WAAW;oBACtC,SAAS;oBACT,UAAU;gBACd;gBAEA,aAAa,OAAO,CAAC,IAAI;0CAAC;wBACtB,UAAU,SAAS,CAAC,MAAM,CAAC;wBAC3B;oBACJ;;YAEJ,OAAO;gBACH;YACJ;YAEA,gBAAgB;YAChB,MAAM,aAAa,SAAS,aAAa,CAAC;YAC1C,uBAAA,iCAAA,WAAY,SAAS,CAAC,MAAM,CAAC;YAC7B,MAAM,OAAO,SAAS,gBAAgB,CAAC;YACvC,IAAI,MAAM;gBACN,IAAI,QAAQ,KAAK,MAAM,EACnB,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC;YAClC;QACJ;6BAAG;QAAC;QAAO;KAAK;IAIhB,SAAS;QACL,IAAI,KAAK,MAAM,IAAI,GACf;QAEJ,SAAS,CAAA,YAAa,aAAa,KAAK,MAAM,GAAG,IAAI,IAAI,YAAY;IACzE;IACA,SAAS;QACL,IAAI,KAAK,MAAM,IAAI,GACf;QAEJ,SAAS,CAAA,YAAa,aAAa,IAAI,KAAK,MAAM,GAAG,IAAI,YAAY;IACzE;IAEA,qCAAqC;IACrC,8BAA8B;IAC9B,oCAAoC;IACpC,MAAM;IAEN,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;gBAAsB,SAAS;0BAAe;;;;;;YAC/D;0BACD,6LAAC;gBAAO,WAAU;gBAAuB,SAAS;0BAAe;;;;;;0BACjE,6LAAC;gBAAI,WAAU;;;;;;;;;;;;AAK3B;GAxJgB;KAAA","debugId":null}}]
}