{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/s/Documents/Programmazione/GitHub/MyRepositories/eC/ec/src/components/Carousel/Carousel.tsx"],"sourcesContent":["\"use client\";\nimport { useQuery } from \"@tanstack/react-query\"\nimport { getProducts } from \"@/lib/graphql/graphql\";\nimport { ReactElement, useEffect, useRef, useState } from \"react\";\nimport gsap from \"gsap\";\nimport \"./Carousel.css\"\n\n\nfunction renderImgs(imgsInfo: [string, string][]): ReactElement[] {\n    return imgsInfo.map<ReactElement>((imgInfo, i) => <img key={i} src={String(imgInfo[0])} alt={imgInfo[1]} className=\"cursor-pointer\" />);\n}\n\n\nexport type CarouselElement = {\n    img: string,\n    imgAlt: string,\n    link: string\n}\n\nexport function Carousel(props: { elements: CarouselElement[] }) {\n    const [imgs, setImgs] = useState<ReactElement[]>([]);\n    const [index, setIndex] = useState(0);\n    const currentTween = useRef<gsap.core.Tween>(null);\n\n\n    useEffect(() => {\n        const imgsInfo: [string, string][] = [];\n        props.elements.forEach(el => imgsInfo.push([el.img, el.imgAlt]));\n\n        setImgs(renderImgs(imgsInfo));\n    }, [props.elements]);\n\n\n    useEffect(() => {\n        const dotsDiv = document.querySelector<HTMLDivElement>(\".carousel-dots-container\");\n        console.log(\"1: \", dotsDiv);\n        if (dotsDiv) {\n\n            console.log(imgs.length)\n\n            const dots = [...dotsDiv.children];\n            dots.forEach( dot => {\n                dotsDiv.removeChild(dot);\n            });\n\n            for(let i = 0; i < imgs.length; i++){\n                const newDot = document.createElement(\"div\");\n                newDot.classList.add(\"carousel-dot\");\n                console.log(newDot)\n                dotsDiv.appendChild(newDot);\n            }\n        }\n\n\n    }, [imgs]);\n\n\n    // This function Shows the image with the index equal to the state variable\n    function selectActiveImage() {\n        const images = document.querySelectorAll<HTMLImageElement>(\".carousel img\");\n        if (images && images.length > 0) {\n            const img = images[index] as HTMLImageElement;\n            img.classList.add(\"active\");\n            gsap.to(img, {\n                opacity: 1,\n                duration: 0.5,\n            });\n        }\n    }\n\n    // This functon hide the previously active image and call 'selectActiveImage' right after. Also changes the selected dot at the bottom of the carousel\n    useEffect(() => {\n\n        // Image selection\n        const activeImg = document.querySelector<HTMLImageElement>(\".carousel img.active\");\n        if (activeImg) {\n            if(currentTween.current){\n                currentTween.current.render(0);\n                currentTween.current.kill();\n                currentTween.current = null;\n            }\n\n            currentTween.current = gsap.to(activeImg, {\n                opacity: 0,\n                duration: 0.5,\n            });\n\n            currentTween.current.then(() => {\n                activeImg.classList.toggle(\"active\");\n                selectActiveImage();\n            });\n            \n        } else {\n            selectActiveImage();\n        }\n\n        // Dot selection\n        const currentDot = document.querySelector(\".selected-carousel-dot\");\n        currentDot?.classList.remove(\"selected-carousel-dot\");\n        const dots = document.querySelectorAll(\".carousel-dot\");\n        if(dots){\n            if(index < dots.length)\n                dots[index].classList.add(\"selected-carousel-dot\")\n        }\n    }, [index, imgs]);\n\n\n\n    function increaseIndex() {\n        if (imgs.length == 0)\n            return;\n\n        setIndex(prevIndex => prevIndex >= imgs.length - 1 ? 0 : prevIndex + 1);\n    }\n    function decreaseIndex() {\n        if (imgs.length <= 0)\n            return;\n\n        setIndex(prevIndex => prevIndex <= 0 ? imgs.length - 1 : prevIndex - 1);\n    }\n\n    // const { data, error } = useQuery({\n    //     queryKey: [\"products\"],\n    //     queryFn: () => getProducts(),\n    // });\n\n    return (\n        <div className=\"carousel\">\n            <button className=\"carousel-arrow left\" onClick={decreaseIndex}>❮</button>\n            {imgs}\n            <button className=\"carousel-arrow right\" onClick={increaseIndex}>❯</button>\n            <div className=\"carousel-dots-container\">\n\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":";;;;AAGA;AACA;;;AAJA;;;;AAQA,SAAS,WAAW,QAA4B;IAC5C,OAAO,SAAS,GAAG,CAAe,CAAC,SAAS,kBAAM,6LAAC;YAAY,KAAK,OAAO,OAAO,CAAC,EAAE;YAAG,KAAK,OAAO,CAAC,EAAE;YAAE,WAAU;WAAvD;;;;;AAChE;AASO,SAAS,SAAS,KAAsC;;IAC3D,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB,EAAE;IACnD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAmB;IAG7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACN,MAAM,WAA+B,EAAE;YACvC,MAAM,QAAQ,CAAC,OAAO;sCAAC,CAAA,KAAM,SAAS,IAAI,CAAC;wBAAC,GAAG,GAAG;wBAAE,GAAG,MAAM;qBAAC;;YAE9D,QAAQ,WAAW;QACvB;6BAAG;QAAC,MAAM,QAAQ;KAAC;IAGnB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACN,MAAM,UAAU,SAAS,aAAa,CAAiB;YACvD,QAAQ,GAAG,CAAC,OAAO;YACnB,IAAI,SAAS;gBAET,QAAQ,GAAG,CAAC,KAAK,MAAM;gBAEvB,MAAM,OAAO;uBAAI,QAAQ,QAAQ;iBAAC;gBAClC,KAAK,OAAO;0CAAE,CAAA;wBACV,QAAQ,WAAW,CAAC;oBACxB;;gBAEA,IAAI,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,EAAE,IAAI;oBAChC,MAAM,SAAS,SAAS,aAAa,CAAC;oBACtC,OAAO,SAAS,CAAC,GAAG,CAAC;oBACrB,QAAQ,GAAG,CAAC;oBACZ,QAAQ,WAAW,CAAC;gBACxB;YACJ;QAGJ;6BAAG;QAAC;KAAK;IAGT,2EAA2E;IAC3E,SAAS;QACL,MAAM,SAAS,SAAS,gBAAgB,CAAmB;QAC3D,IAAI,UAAU,OAAO,MAAM,GAAG,GAAG;YAC7B,MAAM,MAAM,MAAM,CAAC,MAAM;YACzB,IAAI,SAAS,CAAC,GAAG,CAAC;YAClB,gJAAA,CAAA,UAAI,CAAC,EAAE,CAAC,KAAK;gBACT,SAAS;gBACT,UAAU;YACd;QACJ;IACJ;IAEA,sJAAsJ;IACtJ,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YAEN,kBAAkB;YAClB,MAAM,YAAY,SAAS,aAAa,CAAmB;YAC3D,IAAI,WAAW;gBACX,IAAG,aAAa,OAAO,EAAC;oBACpB,aAAa,OAAO,CAAC,MAAM,CAAC;oBAC5B,aAAa,OAAO,CAAC,IAAI;oBACzB,aAAa,OAAO,GAAG;gBAC3B;gBAEA,aAAa,OAAO,GAAG,gJAAA,CAAA,UAAI,CAAC,EAAE,CAAC,WAAW;oBACtC,SAAS;oBACT,UAAU;gBACd;gBAEA,aAAa,OAAO,CAAC,IAAI;0CAAC;wBACtB,UAAU,SAAS,CAAC,MAAM,CAAC;wBAC3B;oBACJ;;YAEJ,OAAO;gBACH;YACJ;YAEA,gBAAgB;YAChB,MAAM,aAAa,SAAS,aAAa,CAAC;YAC1C,uBAAA,iCAAA,WAAY,SAAS,CAAC,MAAM,CAAC;YAC7B,MAAM,OAAO,SAAS,gBAAgB,CAAC;YACvC,IAAG,MAAK;gBACJ,IAAG,QAAQ,KAAK,MAAM,EAClB,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC;YAClC;QACJ;6BAAG;QAAC;QAAO;KAAK;IAIhB,SAAS;QACL,IAAI,KAAK,MAAM,IAAI,GACf;QAEJ,SAAS,CAAA,YAAa,aAAa,KAAK,MAAM,GAAG,IAAI,IAAI,YAAY;IACzE;IACA,SAAS;QACL,IAAI,KAAK,MAAM,IAAI,GACf;QAEJ,SAAS,CAAA,YAAa,aAAa,IAAI,KAAK,MAAM,GAAG,IAAI,YAAY;IACzE;IAEA,qCAAqC;IACrC,8BAA8B;IAC9B,oCAAoC;IACpC,MAAM;IAEN,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;gBAAsB,SAAS;0BAAe;;;;;;YAC/D;0BACD,6LAAC;gBAAO,WAAU;gBAAuB,SAAS;0BAAe;;;;;;0BACjE,6LAAC;gBAAI,WAAU;;;;;;;;;;;;AAK3B;GArHgB;KAAA","debugId":null}}]
}