{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///home/s/Documents/Programmazione/GitHub/MyRepositories/eC/ec/src/components/Carousel/Carousel.tsx"],"sourcesContent":["\"use client\";\nimport { useQuery } from \"@tanstack/react-query\"\nimport { getProducts } from \"@/lib/graphql/graphql\";\nimport { ReactElement, useEffect, useRef, useState } from \"react\";\nimport gsap from \"gsap\";\nimport \"./Carousel.css\"\nimport { clearInterval } from \"timers\";\n\n\nconst carouselTransition = 0.4; // in seconds\nconst scrollInterval = 5; // in seconds\n\n\nfunction renderImgs(imgsInfo: [string, string][]): ReactElement[] {\n    return imgsInfo.map<ReactElement>((imgInfo, i) => <img key={i} src={String(imgInfo[0])} alt={imgInfo[1]} className=\"cursor-pointer\" />);\n}\n\n\nexport type CarouselElement = {\n    img: string,\n    imgAlt: string,\n    link: string\n}\n\nexport function Carousel(props: { elements: CarouselElement[] }) {\n    var [imgs, setImgs] = useState<ReactElement[]>([]);\n    var [index, setIndex] = useState(0);\n    const [autoScroll, setAutoScroll] = useState(true);\n    const autoScrollInterval = useRef<ReturnType<typeof window.setInterval> | null>(null);\n    const currentTween = useRef<gsap.core.Tween>(null);\n\n\n    useEffect(() => {\n        const imgsInfo: [string, string][] = [];\n        props.elements.forEach(el => imgsInfo.push([el.img, el.imgAlt]));\n\n        setImgs(renderImgs(imgsInfo));\n    }, [props.elements]);\n\n\n    function activeAutoScroll() {\n\n        if (!autoScrollInterval.current) {\n            autoScrollInterval.current = window.setInterval(() => {\n                console.log(index, \" \", imgs.length);\n                if (index >= imgs.length - 1) {\n                    console.log(\"1\");\n                    setIndex(0);\n                } else {\n                    console.log(\"2\");\n                    setIndex(prevIndex => prevIndex++);\n                }\n            }, scrollInterval * 1000)\n        }\n\n    }\n\n    useEffect(() => {\n\n        if (imgs.length == 0) {\n            return;\n        }\n\n        if (autoScroll) {\n            activeAutoScroll();\n        } else {\n            if (autoScrollInterval.current) {\n                clearInterval(autoScrollInterval.current);\n                autoScrollInterval.current = null;\n            }\n        }\n    }, [autoScroll])\n\n\n    useEffect(() => {\n        const dotsDiv = document.querySelector<HTMLDivElement>(\".carousel-dots-container\");\n        if (dotsDiv) {\n\n            const dots = [...dotsDiv.children];\n            dots.forEach(dot => {\n                dotsDiv.removeChild(dot);\n            });\n\n            for (let i = 0; i < imgs.length; i++) {\n                const newDot = document.createElement(\"div\");\n                newDot.classList.add(\"carousel-dot\");\n                dotsDiv.appendChild(newDot);\n            }\n        }\n\n        if (autoScroll) {\n            if(autoScrollInterval.current){\n                clearInterval(autoScrollInterval.current)\n                autoScrollInterval.current = null;\n            }\n            activeAutoScroll();\n        }\n    }, [imgs]);\n\n\n    // This function Shows the image with the index equal to the state variable\n    function selectActiveImage() {\n\n        const images = document.querySelectorAll<HTMLImageElement>(\".carousel img\");\n\n        if (images && images.length > 0) {\n            const img = images[index] as HTMLImageElement;\n            img.classList.add(\"active\");\n\n            gsap.to(img, {\n                opacity: 1,\n                duration: carouselTransition,\n            });\n        }\n    }\n\n    // This functon hide the previously active image and call 'selectActiveImage' right after. Also changes the selected dot at the bottom of the carousel\n    useEffect(() => {\n\n        // Image selection\n        const activeImg = document.querySelector<HTMLImageElement>(\".carousel img.active\");\n        if (activeImg) {\n\n            if (currentTween.current && currentTween.current.isActive()) {\n                currentTween.current.kill();\n                currentTween.current = null;\n            }\n\n            currentTween.current = gsap.to(activeImg, {\n                opacity: 0,\n                duration: carouselTransition,\n            });\n\n            currentTween.current.then(() => {\n                activeImg.classList.toggle(\"active\");\n                selectActiveImage();\n            });\n\n        } else {\n            selectActiveImage();\n        }\n\n        // Dot selection\n        const currentDot = document.querySelector(\".selected-carousel-dot\");\n        currentDot?.classList.remove(\"selected-carousel-dot\");\n        const dots = document.querySelectorAll(\".carousel-dot\");\n        if (dots) {\n            if (index < dots.length)\n                dots[index].classList.add(\"selected-carousel-dot\")\n        }\n    }, [index, imgs]);\n\n\n\n    function increaseIndex() {\n        if (imgs.length == 0)\n            return;\n\n        setIndex(prevIndex => prevIndex >= imgs.length - 1 ? 0 : prevIndex + 1);\n    }\n    function decreaseIndex() {\n        if (imgs.length <= 0)\n            return;\n\n        setIndex(prevIndex => prevIndex <= 0 ? imgs.length - 1 : prevIndex - 1);\n    }\n\n    // const { data, error } = useQuery({\n    //     queryKey: [\"products\"],\n    //     queryFn: () => getProducts(),\n    // });\n\n    return (\n        <div className=\"carousel\">\n            <button className=\"carousel-arrow left\" onClick={decreaseIndex}>❮</button>\n            {imgs}\n            <button className=\"carousel-arrow right\" onClick={increaseIndex}>❯</button>\n            <div className=\"carousel-dots-container\"></div>\n        </div>\n    );\n}"],"names":[],"mappings":"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","debugId":null}}]
}